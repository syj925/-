# ğŸ  æ ¡å›­å¢™è½®æ’­å›¾åŠŸèƒ½è®¾è®¡æ–‡æ¡£

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

### åŠŸèƒ½å®šä½
è½®æ’­å›¾ä½œä¸ºæ ¡å›­å¢™é¡¹ç›®çš„é‡è¦è§†è§‰ç»„ä»¶ï¼Œç”¨äºå±•ç¤ºæ ¡å›­é‡è¦æ´»åŠ¨ã€çƒ­é—¨å†…å®¹æ¨èã€åŠŸèƒ½å¼•å¯¼ç­‰ï¼Œæå‡ç”¨æˆ·ä½“éªŒå’Œå†…å®¹æ›å…‰åº¦ã€‚

### åº”ç”¨åœºæ™¯
- **é¦–é¡µè½®æ’­å›¾**ï¼šå±•ç¤ºé‡è¦é€šçŸ¥ã€çƒ­é—¨æ´»åŠ¨ã€ç²¾é€‰å†…å®¹
- **å‘ç°é¡µè½®æ’­å›¾**ï¼šå†…å®¹å‘ç°å¼•å¯¼ã€è¯é¢˜æ¨èã€æ´»åŠ¨å®£ä¼ 
- **æœç´¢é¡µè½®æ’­å›¾**ï¼šæœç´¢å¼•å¯¼ã€çƒ­é—¨è¯é¢˜æ¨èã€åŠŸèƒ½ä»‹ç»

## ğŸ¯ åŠŸèƒ½éœ€æ±‚åˆ†æ

### æ ¸å¿ƒåŠŸèƒ½
1. **å¤šåœºæ™¯å±•ç¤º**ï¼šæ”¯æŒé¦–é¡µã€å‘ç°é¡µã€æœç´¢é¡µç­‰å¤šä¸ªé¡µé¢
2. **æ™ºèƒ½è·³è½¬**ï¼šæ”¯æŒè·³è½¬åˆ°å¸–å­ã€è¯é¢˜ã€æ´»åŠ¨ã€å¤–éƒ¨é“¾æ¥ç­‰
3. **æ—¶é—´æ§åˆ¶**ï¼šæ”¯æŒå®šæ—¶å±•ç¤ºå’Œè‡ªåŠ¨è¿‡æœŸ
4. **å¹³å°é€‚é…**ï¼šæ”¯æŒä¸åŒå¹³å°çš„å·®å¼‚åŒ–å±•ç¤º
5. **æ•°æ®ç»Ÿè®¡**ï¼šè®°å½•å±•ç¤ºæ¬¡æ•°å’Œç‚¹å‡»æ¬¡æ•°

### ç®¡ç†åŠŸèƒ½
1. **å†…å®¹ç®¡ç†**ï¼šè½®æ’­å›¾çš„å¢åˆ æ”¹æŸ¥
2. **æ’åºç®¡ç†**ï¼šæ”¯æŒæ‹–æ‹½æ’åºå’Œæƒé‡è®¾ç½®
3. **çŠ¶æ€æ§åˆ¶**ï¼šå¯ç”¨/ç¦ç”¨çŠ¶æ€ç®¡ç†
4. **æ•°æ®åˆ†æ**ï¼šç‚¹å‡»ç‡ã€å±•ç¤ºæ•ˆæœåˆ†æ

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„è®¾è®¡

### å‰ç«¯æ¶æ„
```
uni-APP/src/
â”œâ”€â”€ components/
â”‚   â””â”€â”€ common/
â”‚       â””â”€â”€ Banner.vue          # é€šç”¨è½®æ’­å›¾ç»„ä»¶
â”œâ”€â”€ api/
â”‚   â””â”€â”€ modules/
â”‚       â””â”€â”€ banner.js           # è½®æ’­å›¾APIå°è£…
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ index/
â”‚   â”‚   â””â”€â”€ home.vue           # é¦–é¡µé›†æˆ
â”‚   â”œâ”€â”€ discover/
â”‚   â”‚   â””â”€â”€ discover.vue       # å‘ç°é¡µé›†æˆ
â”‚   â””â”€â”€ search/
â”‚       â””â”€â”€ index.vue          # æœç´¢é¡µé›†æˆ
â””â”€â”€ stores/
    â””â”€â”€ banner.js              # è½®æ’­å›¾çŠ¶æ€ç®¡ç†
```

### åç«¯æ¶æ„
```
server/src/
â”œâ”€â”€ models/
â”‚   â””â”€â”€ banner.model.js        # è½®æ’­å›¾æ•°æ®æ¨¡å‹
â”œâ”€â”€ controllers/
â”‚   â””â”€â”€ banner.controller.js   # è½®æ’­å›¾æ§åˆ¶å™¨
â”œâ”€â”€ services/
â”‚   â””â”€â”€ banner.service.js      # è½®æ’­å›¾ä¸šåŠ¡é€»è¾‘
â”œâ”€â”€ repositories/
â”‚   â””â”€â”€ banner.repository.js   # è½®æ’­å›¾æ•°æ®è®¿é—®
â”œâ”€â”€ routes/
â”‚   â””â”€â”€ banner.routes.js       # è½®æ’­å›¾è·¯ç”±
â””â”€â”€ migrations/
    â””â”€â”€ create-banners-table.js # æ•°æ®åº“è¿ç§»
```

## ğŸ“Š æ•°æ®åº“è®¾è®¡

### è½®æ’­å›¾è¡¨ç»“æ„
```sql
CREATE TABLE banners (
  id VARCHAR(36) PRIMARY KEY COMMENT 'è½®æ’­å›¾ID',
  title VARCHAR(100) NOT NULL COMMENT 'è½®æ’­å›¾æ ‡é¢˜',
  image VARCHAR(255) NOT NULL COMMENT 'è½®æ’­å›¾ç‰‡URL',
  link_type ENUM('url', 'post', 'topic', 'event', 'page') DEFAULT 'url' COMMENT 'é“¾æ¥ç±»å‹',
  link_value VARCHAR(255) COMMENT 'é“¾æ¥å€¼',
  target_id VARCHAR(36) COMMENT 'ç›®æ ‡èµ„æºID',
  scene ENUM('home', 'discover', 'search-main', 'search-topic') DEFAULT 'home' COMMENT 'å±•ç¤ºåœºæ™¯',
  platform ENUM('app', 'web', 'admin', 'all') DEFAULT 'all' COMMENT 'å±•ç¤ºå¹³å°',
  sort_order INT DEFAULT 0 COMMENT 'æ’åºæƒé‡',
  priority INT DEFAULT 0 COMMENT 'ä¼˜å…ˆçº§',
  status ENUM('active', 'inactive') DEFAULT 'active' COMMENT 'çŠ¶æ€',
  start_time TIMESTAMP COMMENT 'å¼€å§‹æ—¶é—´',
  end_time TIMESTAMP COMMENT 'ç»“æŸæ—¶é—´',
  click_count INT DEFAULT 0 COMMENT 'ç‚¹å‡»æ¬¡æ•°',
  view_count INT DEFAULT 0 COMMENT 'å±•ç¤ºæ¬¡æ•°',
  tags JSON COMMENT 'æ ‡ç­¾ï¼ˆJSONæ•°ç»„ï¼‰',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  deleted_at TIMESTAMP NULL,
  
  INDEX idx_scene_platform_status (scene, platform, status),
  INDEX idx_sort_priority (sort_order, priority),
  INDEX idx_time_range (start_time, end_time)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='è½®æ’­å›¾è¡¨';
```

## ğŸ¨ UI/UXè®¾è®¡è§„èŒƒ

### è®¾è®¡åŸåˆ™
1. **ä¸€è‡´æ€§**ï¼šå„é¡µé¢è½®æ’­å›¾ä¿æŒè§†è§‰é£æ ¼ç»Ÿä¸€
2. **é€‚é…æ€§**ï¼šæ”¯æŒä¸åŒå±å¹•å°ºå¯¸å’Œè®¾å¤‡ç±»å‹
3. **å¯è®¿é—®æ€§**ï¼šæ”¯æŒæ— éšœç¢è®¿é—®å’Œæ“ä½œ
4. **æ€§èƒ½ä¼˜åŒ–**ï¼šå›¾ç‰‡æ‡’åŠ è½½å’Œç¼“å­˜ç­–ç•¥

### åœºæ™¯åŒ–è®¾è®¡
| åœºæ™¯ | å°ºå¯¸ | ç‰¹è‰²åŠŸèƒ½ | æ ·å¼ç‰¹ç‚¹ |
|------|------|----------|----------|
| é¦–é¡µ | 400rpx | æ ‡é¢˜+å‰¯æ ‡é¢˜ | å¤§åœ†è§’ï¼Œæ¸å˜é®ç½© |
| å‘ç°é¡µ | 320rpx | æ ‡é¢˜+æ ‡ç­¾ | ä¸­åœ†è§’ï¼Œå½©è‰²æŒ‡ç¤ºå™¨ |
| æœç´¢ä¸»ä½ | 280rpx | åˆ†ç±»æ ‡ç­¾ | å°åœ†è§’ï¼Œè‡ªå®šä¹‰æŒ‡ç¤ºå™¨ |
| æœç´¢è¯é¢˜ä½ | 200rpx | å¼•å¯¼æ–‡æ¡ˆ | æç®€è®¾è®¡ï¼Œæ— æŒ‡ç¤ºå™¨ |

## ğŸ”§ æ ¸å¿ƒç»„ä»¶è®¾è®¡

### Bannerç»„ä»¶æ¥å£
```typescript
interface BannerProps {
  scene: 'home' | 'discover' | 'search-main' | 'search-topic'
  config?: BannerConfig
  customClass?: string
}

interface BannerConfig {
  height?: string
  showIndicators?: boolean
  showTitle?: boolean
  showSubtitle?: boolean
  autoplay?: boolean
  interval?: number
  borderRadius?: string
  titleStyle?: object
  subtitleStyle?: object
}
```

### APIæ¥å£è®¾è®¡
```javascript
// è·å–è½®æ’­å›¾åˆ—è¡¨
GET /api/banners?scene=home&platform=app&status=active&limit=5

// æ ¹æ®åœºæ™¯è·å–è½®æ’­å›¾
GET /api/banners/scene/:scene?platform=app&limit=5

// è®°å½•è½®æ’­å›¾ç‚¹å‡»
POST /api/banners/click
{
  "bannerId": "uuid",
  "scene": "home",
  "platform": "app"
}

// è®°å½•è½®æ’­å›¾å±•ç¤º
POST /api/banners/view
{
  "bannerIds": ["uuid1", "uuid2"],
  "scene": "home",
  "platform": "app"
}
```

## ğŸ“± é¡µé¢é›†æˆæ–¹æ¡ˆ

### é¦–é¡µé›†æˆ
```vue
<!-- uni-APP/src/pages/index/home.vue -->
<template>
  <view class="home-container">
    <!-- ç°æœ‰å¤´éƒ¨ -->
    <view class="header">...</view>
    
    <!-- è½®æ’­å›¾ -->
    <Banner 
      scene="home"
      class="home-banner"
      @banner-click="onHomeBannerClick"
    />
    
    <!-- ç°æœ‰å†…å®¹ -->
    <view class="content">...</view>
  </view>
</template>
```

### å‘ç°é¡µé›†æˆ
```vue
<!-- uni-APP/src/pages/discover/discover.vue -->
<template>
  <view class="discover-container">
    <!-- æœç´¢æ  -->
    <view class="search-header">...</view>
    
    <!-- è½®æ’­å›¾ -->
    <Banner 
      scene="discover"
      class="discover-banner"
      @banner-click="onDiscoverBannerClick"
    />
    
    <!-- å¿«æ·å¯¼èˆªå’Œå†…å®¹ -->
    <view class="content-sections">...</view>
  </view>
</template>
```

### æœç´¢é¡µé›†æˆ
```vue
<!-- uni-APP/src/pages/search/index.vue -->
<template>
  <view class="search-page">
    <!-- æœç´¢å¤´éƒ¨ -->
    <view class="search-header">...</view>
    
    <!-- å‘ç°å†…å®¹åŒºåŸŸ -->
    <scroll-view v-if="!searchKeyword" class="discover-content" scroll-y>
      <!-- ä¸»æ¨èä½è½®æ’­å›¾ -->
      <Banner 
        scene="search-main"
        class="search-banner-main"
        @banner-click="onSearchBannerClick"
      />
      
      <!-- æœç´¢å†å² -->
      <view class="discover-section">...</view>
      
      <!-- è¯é¢˜æ¨èä½è½®æ’­å›¾ -->
      <Banner 
        scene="search-topic"
        class="search-banner-topic"
        @banner-click="onTopicBannerClick"
      />
      
      <!-- çƒ­é—¨è¯é¢˜ -->
      <view class="discover-section">...</view>
    </scroll-view>
  </view>
</template>
```

## ğŸš€ å¼€å‘è®¡åˆ’

### ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€åŠŸèƒ½å¼€å‘ï¼ˆ5å¤©ï¼‰
- [ ] æ•°æ®åº“è¡¨åˆ›å»ºå’Œè¿ç§»è„šæœ¬
- [ ] åç«¯åŸºç¡€CRUD APIå¼€å‘
- [ ] å‰ç«¯Bannerç»„ä»¶å¼€å‘
- [ ] é¦–é¡µè½®æ’­å›¾é›†æˆ

### ç¬¬äºŒé˜¶æ®µï¼šå¤šåœºæ™¯æ”¯æŒï¼ˆ3å¤©ï¼‰
- [ ] åœºæ™¯åŒ–é…ç½®ç³»ç»Ÿ
- [ ] å‘ç°é¡µè½®æ’­å›¾é›†æˆ
- [ ] æœç´¢é¡µè½®æ’­å›¾é›†æˆ
- [ ] æ ·å¼ä¼˜åŒ–å’Œé€‚é…

### ç¬¬ä¸‰é˜¶æ®µï¼šç®¡ç†åŠŸèƒ½ï¼ˆ2å¤©ï¼‰
- [ ] ç®¡ç†åå°APIå¯¹æ¥ä¿®å¤
- [ ] å›¾ç‰‡ä¸Šä¼ å’Œç®¡ç†åŠŸèƒ½
- [ ] æ’åºå’ŒçŠ¶æ€ç®¡ç†

### ç¬¬å››é˜¶æ®µï¼šé«˜çº§åŠŸèƒ½ï¼ˆ3å¤©ï¼‰
- [ ] ç‚¹å‡»ç»Ÿè®¡å’Œæ•°æ®åˆ†æ
- [ ] æ—¶é—´æ§åˆ¶å’Œè‡ªåŠ¨è¿‡æœŸ
- [ ] æ€§èƒ½ä¼˜åŒ–å’Œç¼“å­˜ç­–ç•¥
- [ ] æµ‹è¯•å’Œæ–‡æ¡£å®Œå–„

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### å‰ç«¯ä¼˜åŒ–
1. **å›¾ç‰‡æ‡’åŠ è½½**ï¼šä½¿ç”¨uni-appçš„lazy-loadå±æ€§
2. **æ•°æ®ç¼“å­˜**ï¼šPiniaçŠ¶æ€ç®¡ç†ç¼“å­˜è½®æ’­å›¾æ•°æ®
3. **ç»„ä»¶å¤ç”¨**ï¼šç»Ÿä¸€çš„Bannerç»„ä»¶æ”¯æŒå¤šåœºæ™¯
4. **é¢„åŠ è½½ç­–ç•¥**ï¼šå…³é”®é¡µé¢è½®æ’­å›¾æ•°æ®é¢„åŠ è½½

### åç«¯ä¼˜åŒ–
1. **Redisç¼“å­˜**ï¼šç¼“å­˜æ´»è·ƒè½®æ’­å›¾æ•°æ®
2. **æ•°æ®åº“ç´¢å¼•**ï¼šä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½
3. **CDNåŠ é€Ÿ**ï¼šå›¾ç‰‡èµ„æºCDNåˆ†å‘
4. **æ¥å£åˆå¹¶**ï¼šå‡å°‘APIè¯·æ±‚æ¬¡æ•°

## ğŸ”’ å®‰å…¨è€ƒè™‘

### æ•°æ®å®‰å…¨
1. **è¾“å…¥éªŒè¯**ï¼šä¸¥æ ¼éªŒè¯ä¸Šä¼ çš„å›¾ç‰‡å’Œé“¾æ¥
2. **XSSé˜²æŠ¤**ï¼šè¿‡æ»¤å’Œè½¬ä¹‰ç”¨æˆ·è¾“å…¥å†…å®¹
3. **æƒé™æ§åˆ¶**ï¼šç®¡ç†å‘˜æƒé™éªŒè¯
4. **æ–‡ä»¶å®‰å…¨**ï¼šé™åˆ¶ä¸Šä¼ æ–‡ä»¶ç±»å‹å’Œå¤§å°

### ä¸šåŠ¡å®‰å…¨
1. **å†…å®¹å®¡æ ¸**ï¼šè½®æ’­å›¾å†…å®¹äººå·¥å®¡æ ¸æœºåˆ¶
2. **æ¶æ„ç‚¹å‡»**ï¼šé˜²æ­¢åˆ·ç‚¹å‡»é‡çš„é™æµæœºåˆ¶
3. **æ•°æ®å¤‡ä»½**ï¼šé‡è¦è½®æ’­å›¾æ•°æ®å®šæœŸå¤‡ä»½

## ğŸ“Š æ•°æ®ç»Ÿè®¡åˆ†æ

### ç»Ÿè®¡æŒ‡æ ‡
1. **å±•ç¤ºæ•°æ®**ï¼šè½®æ’­å›¾å±•ç¤ºæ¬¡æ•°ã€å±•ç¤ºæ—¶é•¿
2. **äº¤äº’æ•°æ®**ï¼šç‚¹å‡»æ¬¡æ•°ã€ç‚¹å‡»ç‡ã€è·³è½¬æˆåŠŸç‡
3. **ç”¨æˆ·è¡Œä¸º**ï¼šç”¨æˆ·åœç•™æ—¶é—´ã€æ»‘åŠ¨è¡Œä¸º
4. **æ•ˆæœåˆ†æ**ï¼šä¸åŒåœºæ™¯çš„è½¬åŒ–æ•ˆæœå¯¹æ¯”

### åˆ†æç»´åº¦
- æŒ‰æ—¶é—´ç»´åº¦ï¼šæ—¥ã€å‘¨ã€æœˆç»Ÿè®¡è¶‹åŠ¿
- æŒ‰åœºæ™¯ç»´åº¦ï¼šä¸åŒé¡µé¢çš„æ•ˆæœå¯¹æ¯”
- æŒ‰å†…å®¹ç»´åº¦ï¼šä¸åŒç±»å‹å†…å®¹çš„è¡¨ç°
- æŒ‰ç”¨æˆ·ç»´åº¦ï¼šä¸åŒç”¨æˆ·ç¾¤ä½“çš„åå¥½

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### åŠŸèƒ½æµ‹è¯•
- [ ] è½®æ’­å›¾æ­£å¸¸å±•ç¤ºå’Œåˆ‡æ¢
- [ ] å„ç§è·³è½¬ç±»å‹çš„æ­£ç¡®æ€§
- [ ] ä¸åŒåœºæ™¯çš„æ ·å¼é€‚é…
- [ ] æ•°æ®ç»Ÿè®¡çš„å‡†ç¡®æ€§

### å…¼å®¹æ€§æµ‹è¯•
- [ ] ä¸åŒè®¾å¤‡å±å¹•å°ºå¯¸é€‚é…
- [ ] iOS/Androidç³»ç»Ÿå…¼å®¹æ€§
- [ ] å¾®ä¿¡å°ç¨‹åºå…¼å®¹æ€§
- [ ] H5æµè§ˆå™¨å…¼å®¹æ€§

### æ€§èƒ½æµ‹è¯•
- [ ] å›¾ç‰‡åŠ è½½é€Ÿåº¦æµ‹è¯•
- [ ] å¤§é‡è½®æ’­å›¾çš„æ€§èƒ½è¡¨ç°
- [ ] å†…å­˜ä½¿ç”¨æƒ…å†µç›‘æ§
- [ ] ç½‘ç»œè¯·æ±‚ä¼˜åŒ–æ•ˆæœ

## ğŸ’» æŠ€æœ¯å®ç°ç»†èŠ‚

### Bannerç»„ä»¶å®Œæ•´å®ç°
```vue
<!-- uni-APP/src/components/common/Banner.vue -->
<template>
  <view
    class="banner-container"
    :class="[`banner-${scene}`, customClass]"
    :style="containerStyle"
    v-if="banners.length > 0"
  >
    <swiper
      class="banner-swiper"
      :indicator-dots="config.showIndicators"
      :autoplay="config.autoplay"
      :circular="config.circular"
      :interval="config.interval"
      :duration="config.duration"
      :indicator-color="config.indicatorColor"
      :indicator-active-color="config.indicatorActiveColor"
      @change="onSwiperChange"
    >
      <swiper-item
        v-for="(banner, index) in banners"
        :key="banner.id"
        @tap="handleBannerClick(banner)"
      >
        <view class="banner-item" :class="`banner-item-${scene}`">
          <image
            :src="getBannerImage(banner.image)"
            mode="aspectFill"
            class="banner-image"
            :lazy-load="true"
            @error="onImageError"
            @load="onImageLoad"
          />

          <view class="banner-overlay" :class="`overlay-${scene}`">
            <view v-if="config.showTitle" class="banner-content">
              <text class="banner-title" :style="config.titleStyle">
                {{ banner.title }}
              </text>
              <text
                v-if="config.showSubtitle && banner.subtitle"
                class="banner-subtitle"
                :style="config.subtitleStyle"
              >
                {{ banner.subtitle }}
              </text>
            </view>

            <view v-if="getBannerTag(banner)" class="banner-tag">
              <text class="tag-text">{{ getBannerTag(banner) }}</text>
            </view>
          </view>
        </view>
      </swiper-item>
    </swiper>

    <view
      v-if="config.customIndicators"
      class="custom-indicators"
      :class="`indicators-${scene}`"
    >
      <view
        v-for="(banner, index) in banners"
        :key="index"
        class="indicator-dot"
        :class="{ active: currentIndex === index }"
      ></view>
    </view>
  </view>
</template>

<script setup>
import { ref, computed, onMounted } from 'vue'
import { bannerApi } from '@/api/modules/banner'
import { useBannerStore } from '@/stores/banner'

const props = defineProps({
  scene: {
    type: String,
    default: 'home',
    validator: (value) => ['home', 'discover', 'search-main', 'search-topic'].includes(value)
  },
  config: {
    type: Object,
    default: () => ({})
  },
  customClass: {
    type: String,
    default: ''
  }
})

const emit = defineEmits(['banner-click', 'banner-change'])

// çŠ¶æ€ç®¡ç†
const bannerStore = useBannerStore()
const banners = ref([])
const currentIndex = ref(0)

// åœºæ™¯é…ç½®
const sceneConfigs = {
  home: {
    height: '400rpx',
    showIndicators: true,
    showTitle: true,
    autoplay: true,
    interval: 4000,
    borderRadius: '20rpx'
  },
  discover: {
    height: '320rpx',
    showIndicators: true,
    showTitle: true,
    autoplay: true,
    interval: 5000,
    borderRadius: '16rpx'
  },
  'search-main': {
    height: '280rpx',
    showIndicators: false,
    showTitle: true,
    autoplay: true,
    interval: 6000,
    customIndicators: true
  },
  'search-topic': {
    height: '200rpx',
    showIndicators: false,
    showTitle: false,
    autoplay: true,
    interval: 4000
  }
}

// åˆå¹¶é…ç½®
const finalConfig = computed(() => ({
  ...sceneConfigs[props.scene],
  ...props.config
}))

// å®¹å™¨æ ·å¼
const containerStyle = computed(() => ({
  height: finalConfig.value.height,
  borderRadius: finalConfig.value.borderRadius
}))

// è·å–è½®æ’­å›¾æ•°æ®
const fetchBanners = async () => {
  try {
    const data = await bannerStore.fetchBannersByScene(props.scene)
    banners.value = data

    // è®°å½•å±•ç¤ºç»Ÿè®¡
    if (data.length > 0) {
      recordView(data.map(item => item.id))
    }
  } catch (error) {
    console.error('è·å–è½®æ’­å›¾å¤±è´¥:', error)
  }
}

// å¤„ç†è½®æ’­å›¾ç‚¹å‡»
const handleBannerClick = async (banner) => {
  try {
    // è®°å½•ç‚¹å‡»ç»Ÿè®¡
    await bannerApi.recordClick(banner.id, props.scene)

    // è§¦å‘çˆ¶ç»„ä»¶äº‹ä»¶
    emit('banner-click', banner)

    // æ‰§è¡Œè·³è½¬é€»è¾‘
    await handleNavigation(banner)
  } catch (error) {
    console.error('è½®æ’­å›¾ç‚¹å‡»å¤„ç†å¤±è´¥:', error)
  }
}

// è·³è½¬å¤„ç†
const handleNavigation = async (banner) => {
  switch (banner.link_type) {
    case 'post':
      uni.navigateTo({
        url: `/pages/post/detail?id=${banner.target_id}`
      })
      break
    case 'topic':
      uni.navigateTo({
        url: `/pages/topic/detail?id=${banner.target_id}`
      })
      break
    case 'event':
      uni.navigateTo({
        url: `/pages/event/detail?id=${banner.target_id}`
      })
      break
    case 'page':
      uni.navigateTo({
        url: banner.link_value
      })
      break
    case 'url':
      handleExternalLink(banner.link_value)
      break
    default:
      uni.showToast({
        title: banner.title,
        icon: 'none'
      })
  }
}

// å¤–éƒ¨é“¾æ¥å¤„ç†
const handleExternalLink = (url) => {
  // #ifdef H5
  window.open(url)
  // #endif

  // #ifndef H5
  uni.showModal({
    title: 'æç¤º',
    content: 'å³å°†è·³è½¬åˆ°å¤–éƒ¨é“¾æ¥',
    success: (res) => {
      if (res.confirm) {
        plus.runtime.openURL(url)
      }
    }
  })
  // #endif
}

// è½®æ’­åˆ‡æ¢äº‹ä»¶
const onSwiperChange = (e) => {
  currentIndex.value = e.detail.current
  emit('banner-change', {
    current: e.detail.current,
    banner: banners.value[e.detail.current]
  })
}

// è®°å½•å±•ç¤ºç»Ÿè®¡
const recordView = async (bannerIds) => {
  try {
    await bannerApi.recordView(bannerIds, props.scene)
  } catch (error) {
    console.error('è®°å½•å±•ç¤ºç»Ÿè®¡å¤±è´¥:', error)
  }
}

// è·å–è½®æ’­å›¾æ ‡ç­¾
const getBannerTag = (banner) => {
  switch (props.scene) {
    case 'search-main':
      return banner.link_type === 'topic' ? 'è¯é¢˜' :
             banner.link_type === 'event' ? 'æ´»åŠ¨' :
             banner.link_type === 'post' ? 'çƒ­å¸–' : null
    case 'search-topic':
      return 'æ¨èè¯é¢˜'
    default:
      return null
  }
}

// å›¾ç‰‡URLå¤„ç†
const getBannerImage = (imageUrl) => {
  if (!imageUrl) return '/static/images/default-banner.jpg'
  if (imageUrl.startsWith('http')) return imageUrl
  return `${getApp().globalData.baseUrl}${imageUrl}`
}

// å›¾ç‰‡åŠ è½½é”™è¯¯å¤„ç†
const onImageError = (e) => {
  console.error('è½®æ’­å›¾å›¾ç‰‡åŠ è½½å¤±è´¥:', e)
  // å¯ä»¥è®¾ç½®é»˜è®¤å›¾ç‰‡
}

// å›¾ç‰‡åŠ è½½æˆåŠŸå¤„ç†
const onImageLoad = (e) => {
  console.log('è½®æ’­å›¾å›¾ç‰‡åŠ è½½æˆåŠŸ')
}

onMounted(() => {
  fetchBanners()
})
</script>

<style lang="scss" scoped>
.banner-container {
  width: 100%;
  position: relative;
  overflow: hidden;
  background: #f5f5f5;
}

.banner-swiper {
  width: 100%;
  height: 100%;
}

.banner-item {
  position: relative;
  width: 100%;
  height: 100%;
}

.banner-image {
  width: 100%;
  height: 100%;
}

.banner-overlay {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  background: linear-gradient(transparent, rgba(0,0,0,0.6));
  padding: 40rpx 30rpx 20rpx;
  display: flex;
  justify-content: space-between;
  align-items: flex-end;
}

.banner-content {
  flex: 1;
}

.banner-title {
  color: #ffffff;
  font-size: 32rpx;
  font-weight: 600;
  text-shadow: 0 2rpx 8rpx rgba(0,0,0,0.3);
  display: block;
  margin-bottom: 8rpx;
}

.banner-subtitle {
  color: rgba(255,255,255,0.8);
  font-size: 24rpx;
  display: block;
}

.banner-tag {
  background: rgba(255,255,255,0.9);
  padding: 8rpx 16rpx;
  border-radius: 20rpx;

  .tag-text {
    font-size: 20rpx;
    color: #4A90E2;
    font-weight: 500;
  }
}

.custom-indicators {
  position: absolute;
  bottom: 20rpx;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 12rpx;

  .indicator-dot {
    width: 16rpx;
    height: 16rpx;
    border-radius: 50%;
    background: rgba(255,255,255,0.5);
    transition: all 0.3s ease;

    &.active {
      background: #4A90E2;
      transform: scale(1.2);
    }
  }
}

// åœºæ™¯ç‰¹å®šæ ·å¼
.banner-home {
  box-shadow: 0 8rpx 24rpx rgba(74, 144, 226, 0.15);
}

.banner-discover {
  box-shadow: 0 6rpx 20rpx rgba(74, 144, 226, 0.12);
}

.banner-search-main {
  box-shadow: 0 4rpx 16rpx rgba(74, 144, 226, 0.1);
}

.banner-search-topic {
  box-shadow: 0 2rpx 12rpx rgba(74, 144, 226, 0.08);
}
</style>
```

### åç«¯æœåŠ¡å±‚å®ç°
```javascript
// server/src/services/banner.service.js
const BannerRepository = require('../repositories/banner.repository')
const RedisClient = require('../utils/redis-client')
const logger = require('../../config/logger')

class BannerService {
  /**
   * æ ¹æ®åœºæ™¯è·å–è½®æ’­å›¾
   */
  async getBannersByScene(params) {
    const { scene, platform = 'app', status = 'active', limit = 5 } = params
    const cacheKey = `banners:${scene}:${platform}:${status}:${limit}`

    try {
      // å°è¯•ä»ç¼“å­˜è·å–
      const cached = await RedisClient.get(cacheKey)
      if (cached) {
        return JSON.parse(cached)
      }

      // ä»æ•°æ®åº“è·å–
      const banners = await BannerRepository.findByScene({
        scene,
        platform,
        status,
        limit,
        includeExpired: false
      })

      // å¤„ç†å›¾ç‰‡URL
      const processedBanners = banners.map(banner => ({
        ...banner.toJSON(),
        image: this.processImageUrl(banner.image)
      }))

      // ç¼“å­˜ç»“æœï¼ˆ5åˆ†é’Ÿï¼‰
      await RedisClient.setex(cacheKey, 300, JSON.stringify(processedBanners))

      return processedBanners
    } catch (error) {
      logger.error('è·å–è½®æ’­å›¾å¤±è´¥:', error)
      throw error
    }
  }

  /**
   * è®°å½•è½®æ’­å›¾ç‚¹å‡»
   */
  async recordClick(bannerId, scene = 'home', platform = 'app') {
    try {
      await BannerRepository.incrementClick(bannerId)

      // è®°å½•ç‚¹å‡»æ—¥å¿—
      logger.info('è½®æ’­å›¾ç‚¹å‡»è®°å½•', {
        bannerId,
        scene,
        platform,
        timestamp: new Date()
      })

      return true
    } catch (error) {
      logger.error('è®°å½•è½®æ’­å›¾ç‚¹å‡»å¤±è´¥:', error)
      throw error
    }
  }

  /**
   * è®°å½•è½®æ’­å›¾å±•ç¤º
   */
  async recordView(bannerIds, scene = 'home', platform = 'app') {
    try {
      await BannerRepository.incrementViews(bannerIds)

      // è®°å½•å±•ç¤ºæ—¥å¿—
      logger.info('è½®æ’­å›¾å±•ç¤ºè®°å½•', {
        bannerIds,
        scene,
        platform,
        timestamp: new Date()
      })

      return true
    } catch (error) {
      logger.error('è®°å½•è½®æ’­å›¾å±•ç¤ºå¤±è´¥:', error)
      throw error
    }
  }

  /**
   * å¤„ç†å›¾ç‰‡URL
   */
  processImageUrl(imageUrl) {
    if (!imageUrl) return null
    if (imageUrl.startsWith('http')) return imageUrl

    const baseUrl = process.env.BASE_URL || 'http://localhost:3000'
    return `${baseUrl}${imageUrl.startsWith('/') ? '' : '/'}${imageUrl}`
  }

  /**
   * æ¸…é™¤ç¼“å­˜
   */
  async clearCache(scene = null) {
    try {
      const pattern = scene ? `banners:${scene}:*` : 'banners:*'
      await RedisClient.deletePattern(pattern)

      logger.info('è½®æ’­å›¾ç¼“å­˜æ¸…é™¤æˆåŠŸ', { pattern })
      return true
    } catch (error) {
      logger.error('æ¸…é™¤è½®æ’­å›¾ç¼“å­˜å¤±è´¥:', error)
      throw error
    }
  }
}

module.exports = new BannerService()
```

### æ•°æ®è®¿é—®å±‚å®ç°
```javascript
// server/src/repositories/banner.repository.js
const { Banner } = require('../models')
const { Op } = require('sequelize')

class BannerRepository {
  /**
   * æ ¹æ®åœºæ™¯æŸ¥æ‰¾è½®æ’­å›¾
   */
  async findByScene(params) {
    const { scene, platform, status, limit, includeExpired = false } = params

    const whereConditions = {
      scene,
      status
    }

    // å¹³å°ç­›é€‰
    if (platform !== 'all') {
      whereConditions.platform = {
        [Op.or]: [platform, 'all']
      }
    }

    // æ—¶é—´èŒƒå›´ç­›é€‰
    if (!includeExpired) {
      const now = new Date()
      whereConditions[Op.and] = [
        {
          [Op.or]: [
            { start_time: { [Op.lte]: now } },
            { start_time: null }
          ]
        },
        {
          [Op.or]: [
            { end_time: { [Op.gte]: now } },
            { end_time: null }
          ]
        }
      ]
    }

    return await Banner.findAll({
      where: whereConditions,
      order: [
        ['priority', 'DESC'],
        ['sort_order', 'ASC'],
        ['created_at', 'DESC']
      ],
      limit: parseInt(limit)
    })
  }

  /**
   * å¢åŠ ç‚¹å‡»æ¬¡æ•°
   */
  async incrementClick(bannerId) {
    return await Banner.increment('click_count', {
      where: { id: bannerId }
    })
  }

  /**
   * å¢åŠ å±•ç¤ºæ¬¡æ•°
   */
  async incrementViews(bannerIds) {
    return await Banner.increment('view_count', {
      where: {
        id: {
          [Op.in]: bannerIds
        }
      }
    })
  }

  /**
   * åˆ›å»ºè½®æ’­å›¾
   */
  async create(bannerData) {
    return await Banner.create(bannerData)
  }

  /**
   * æ›´æ–°è½®æ’­å›¾
   */
  async update(id, bannerData) {
    const [affectedRows] = await Banner.update(bannerData, {
      where: { id }
    })

    if (affectedRows === 0) {
      throw new Error('è½®æ’­å›¾ä¸å­˜åœ¨æˆ–æ›´æ–°å¤±è´¥')
    }

    return await Banner.findByPk(id)
  }

  /**
   * åˆ é™¤è½®æ’­å›¾
   */
  async delete(id) {
    const affectedRows = await Banner.destroy({
      where: { id }
    })

    if (affectedRows === 0) {
      throw new Error('è½®æ’­å›¾ä¸å­˜åœ¨æˆ–åˆ é™¤å¤±è´¥')
    }

    return true
  }

  /**
   * æ‰¹é‡æ›´æ–°æ’åº
   */
  async updateSortOrder(sortData) {
    const transaction = await Banner.sequelize.transaction()

    try {
      for (const item of sortData) {
        await Banner.update(
          { sort_order: item.sort_order },
          { where: { id: item.id }, transaction }
        )
      }

      await transaction.commit()
      return true
    } catch (error) {
      await transaction.rollback()
      throw error
    }
  }
}

module.exports = new BannerRepository()
```

### APIæ¥å£å®Œæ•´å®ç°
```javascript
// uni-APP/src/api/modules/banner.js
import request from '../request'

export const bannerApi = {
  /**
   * è·å–è½®æ’­å›¾åˆ—è¡¨
   */
  getList(params = {}) {
    return request.get('/api/banners', {
      platform: 'app',
      status: 'active',
      limit: 5,
      ...params
    })
  },

  /**
   * æ ¹æ®åœºæ™¯è·å–è½®æ’­å›¾
   */
  getBannersByScene(scene, params = {}) {
    return request.get(`/api/banners/scene/${scene}`, {
      platform: 'app',
      status: 'active',
      limit: 5,
      ...params
    })
  },

  /**
   * è®°å½•è½®æ’­å›¾ç‚¹å‡»
   */
  recordClick(bannerId, scene = 'home', platform = 'app') {
    return request.post('/api/banners/click', {
      bannerId,
      scene,
      platform
    })
  },

  /**
   * è®°å½•è½®æ’­å›¾å±•ç¤º
   */
  recordView(bannerIds, scene = 'home', platform = 'app') {
    return request.post('/api/banners/view', {
      bannerIds: Array.isArray(bannerIds) ? bannerIds : [bannerIds],
      scene,
      platform
    })
  },

  /**
   * è·å–è½®æ’­å›¾ç»Ÿè®¡æ•°æ®
   */
  getStatistics(bannerId, dateRange = {}) {
    return request.get(`/api/banners/${bannerId}/statistics`, dateRange)
  }
}
```

### çŠ¶æ€ç®¡ç†å®ç°
```javascript
// uni-APP/src/stores/banner.js
import { defineStore } from 'pinia'
import { bannerApi } from '@/api/modules/banner'

export const useBannerStore = defineStore('banner', {
  state: () => ({
    // å„åœºæ™¯çš„è½®æ’­å›¾æ•°æ®
    banners: {
      home: [],
      discover: [],
      'search-main': [],
      'search-topic': []
    },

    // ç¼“å­˜æ—¶é—´æˆ³
    lastFetchTime: {
      home: 0,
      discover: 0,
      'search-main': 0,
      'search-topic': 0
    },

    // ç¼“å­˜æœ‰æ•ˆæœŸï¼ˆ5åˆ†é’Ÿï¼‰
    cacheExpiry: 5 * 60 * 1000,

    // åŠ è½½çŠ¶æ€
    loading: {
      home: false,
      discover: false,
      'search-main': false,
      'search-topic': false
    }
  }),

  getters: {
    /**
     * è·å–æŒ‡å®šåœºæ™¯çš„è½®æ’­å›¾
     */
    getBannersByScene: (state) => (scene) => {
      return state.banners[scene] || []
    },

    /**
     * æ£€æŸ¥ç¼“å­˜æ˜¯å¦æœ‰æ•ˆ
     */
    isCacheValid: (state) => (scene) => {
      const now = Date.now()
      const lastFetch = state.lastFetchTime[scene] || 0
      return (now - lastFetch) < state.cacheExpiry
    },

    /**
     * è·å–åŠ è½½çŠ¶æ€
     */
    isLoading: (state) => (scene) => {
      return state.loading[scene] || false
    }
  },

  actions: {
    /**
     * è·å–è½®æ’­å›¾æ•°æ®
     */
    async fetchBannersByScene(scene, force = false) {
      // æ£€æŸ¥ç¼“å­˜
      if (!force && this.isCacheValid(scene) && this.banners[scene].length > 0) {
        return this.banners[scene]
      }

      // é˜²æ­¢é‡å¤è¯·æ±‚
      if (this.loading[scene]) {
        return this.banners[scene]
      }

      this.loading[scene] = true

      try {
        const response = await bannerApi.getBannersByScene(scene)

        if (response.code === 0) {
          this.banners[scene] = response.data || []
          this.lastFetchTime[scene] = Date.now()
        }

        return this.banners[scene]
      } catch (error) {
        console.error(`è·å–${scene}è½®æ’­å›¾å¤±è´¥:`, error)
        // è¿”å›ç¼“å­˜æ•°æ®
        return this.banners[scene]
      } finally {
        this.loading[scene] = false
      }
    },

    /**
     * åˆ·æ–°æŒ‡å®šåœºæ™¯çš„è½®æ’­å›¾
     */
    async refreshBanners(scene) {
      return await this.fetchBannersByScene(scene, true)
    },

    /**
     * åˆ·æ–°æ‰€æœ‰è½®æ’­å›¾
     */
    async refreshAllBanners() {
      const scenes = ['home', 'discover', 'search-main', 'search-topic']
      const promises = scenes.map(scene => this.fetchBannersByScene(scene, true))

      try {
        await Promise.all(promises)
      } catch (error) {
        console.error('åˆ·æ–°æ‰€æœ‰è½®æ’­å›¾å¤±è´¥:', error)
      }
    },

    /**
     * æ¸…é™¤ç¼“å­˜
     */
    clearCache(scene = null) {
      if (scene) {
        this.banners[scene] = []
        this.lastFetchTime[scene] = 0
      } else {
        // æ¸…é™¤æ‰€æœ‰ç¼“å­˜
        Object.keys(this.banners).forEach(key => {
          this.banners[key] = []
          this.lastFetchTime[key] = 0
        })
      }
    },

    /**
     * é¢„åŠ è½½è½®æ’­å›¾
     */
    async preloadBanners(scenes = ['home']) {
      const promises = scenes.map(scene => this.fetchBannersByScene(scene))

      try {
        await Promise.all(promises)
      } catch (error) {
        console.error('é¢„åŠ è½½è½®æ’­å›¾å¤±è´¥:', error)
      }
    }
  }
})
```

### è·¯ç”±é…ç½®
```javascript
// server/src/routes/banner.routes.js
const express = require('express')
const router = express.Router()
const BannerController = require('../controllers/banner.controller')
const AuthMiddleware = require('../middlewares/auth.middleware')
const AdminMiddleware = require('../middlewares/admin.middleware')
const Validator = require('../middlewares/validator.middleware')
const { bannerSchemas } = require('../validators/banner.validator')

// å…¬å¼€æ¥å£
router.get('/', BannerController.getList)
router.get('/scene/:scene', BannerController.getBannersByScene)
router.post('/click', BannerController.recordClick)
router.post('/view', BannerController.recordView)

// éœ€è¦ç™»å½•çš„æ¥å£
router.get('/:id/statistics',
  AuthMiddleware.authenticate(),
  BannerController.getStatistics
)

// ç®¡ç†å‘˜æ¥å£
router.post('/',
  AdminMiddleware.authenticate(),
  Validator.validateBody(bannerSchemas.create),
  BannerController.create
)

router.put('/:id',
  AdminMiddleware.authenticate(),
  Validator.validateBody(bannerSchemas.update),
  BannerController.update
)

router.delete('/:id',
  AdminMiddleware.authenticate(),
  BannerController.delete
)

router.put('/sort',
  AdminMiddleware.authenticate(),
  Validator.validateBody(bannerSchemas.sort),
  BannerController.updateSortOrder
)

module.exports = router
```

### æ•°æ®éªŒè¯å™¨
```javascript
// server/src/validators/banner.validator.js
const Joi = require('joi')

const bannerSchemas = {
  create: Joi.object({
    title: Joi.string().max(100).required().messages({
      'string.empty': 'è½®æ’­å›¾æ ‡é¢˜ä¸èƒ½ä¸ºç©º',
      'string.max': 'è½®æ’­å›¾æ ‡é¢˜ä¸èƒ½è¶…è¿‡100ä¸ªå­—ç¬¦'
    }),

    image: Joi.string().uri().required().messages({
      'string.empty': 'è½®æ’­å›¾å›¾ç‰‡ä¸èƒ½ä¸ºç©º',
      'string.uri': 'è½®æ’­å›¾å›¾ç‰‡å¿…é¡»æ˜¯æœ‰æ•ˆçš„URL'
    }),

    link_type: Joi.string().valid('url', 'post', 'topic', 'event', 'page').default('url'),

    link_value: Joi.string().max(255).allow('', null),

    target_id: Joi.string().uuid().allow(null),

    scene: Joi.string().valid('home', 'discover', 'search-main', 'search-topic').default('home'),

    platform: Joi.string().valid('app', 'web', 'admin', 'all').default('all'),

    sort_order: Joi.number().integer().min(0).default(0),

    priority: Joi.number().integer().min(0).default(0),

    status: Joi.string().valid('active', 'inactive').default('active'),

    start_time: Joi.date().allow(null),

    end_time: Joi.date().min(Joi.ref('start_time')).allow(null).messages({
      'date.min': 'ç»“æŸæ—¶é—´å¿…é¡»æ™šäºå¼€å§‹æ—¶é—´'
    }),

    tags: Joi.array().items(Joi.string()).allow(null)
  }),

  update: Joi.object({
    title: Joi.string().max(100),
    image: Joi.string().uri(),
    link_type: Joi.string().valid('url', 'post', 'topic', 'event', 'page'),
    link_value: Joi.string().max(255).allow('', null),
    target_id: Joi.string().uuid().allow(null),
    scene: Joi.string().valid('home', 'discover', 'search-main', 'search-topic'),
    platform: Joi.string().valid('app', 'web', 'admin', 'all'),
    sort_order: Joi.number().integer().min(0),
    priority: Joi.number().integer().min(0),
    status: Joi.string().valid('active', 'inactive'),
    start_time: Joi.date().allow(null),
    end_time: Joi.date().min(Joi.ref('start_time')).allow(null),
    tags: Joi.array().items(Joi.string()).allow(null)
  }),

  sort: Joi.object({
    banners: Joi.array().items(
      Joi.object({
        id: Joi.string().uuid().required(),
        sort_order: Joi.number().integer().min(0).required()
      })
    ).required()
  }),

  click: Joi.object({
    bannerId: Joi.string().uuid().required(),
    scene: Joi.string().valid('home', 'discover', 'search-main', 'search-topic').default('home'),
    platform: Joi.string().valid('app', 'web').default('app')
  }),

  view: Joi.object({
    bannerIds: Joi.array().items(Joi.string().uuid()).required(),
    scene: Joi.string().valid('home', 'discover', 'search-main', 'search-topic').default('home'),
    platform: Joi.string().valid('app', 'web').default('app')
  })
}

module.exports = { bannerSchemas }
```

## ğŸš€ éƒ¨ç½²å’Œè¿ç»´

### æ•°æ®åº“è¿ç§»è„šæœ¬
```javascript
// server/src/migrations/20250108000001-create-banners-table.js
'use strict'

module.exports = {
  async up(queryInterface, Sequelize) {
    await queryInterface.createTable('banners', {
      id: {
        type: Sequelize.UUID,
        primaryKey: true,
        defaultValue: Sequelize.UUIDV4,
        allowNull: false
      },
      title: {
        type: Sequelize.STRING(100),
        allowNull: false,
        comment: 'è½®æ’­å›¾æ ‡é¢˜'
      },
      image: {
        type: Sequelize.STRING(255),
        allowNull: false,
        comment: 'è½®æ’­å›¾ç‰‡URL'
      },
      link_type: {
        type: Sequelize.ENUM('url', 'post', 'topic', 'event', 'page'),
        defaultValue: 'url',
        comment: 'é“¾æ¥ç±»å‹'
      },
      link_value: {
        type: Sequelize.STRING(255),
        allowNull: true,
        comment: 'é“¾æ¥å€¼'
      },
      target_id: {
        type: Sequelize.UUID,
        allowNull: true,
        comment: 'ç›®æ ‡èµ„æºID'
      },
      scene: {
        type: Sequelize.ENUM('home', 'discover', 'search-main', 'search-topic'),
        defaultValue: 'home',
        comment: 'å±•ç¤ºåœºæ™¯'
      },
      platform: {
        type: Sequelize.ENUM('app', 'web', 'admin', 'all'),
        defaultValue: 'all',
        comment: 'å±•ç¤ºå¹³å°'
      },
      sort_order: {
        type: Sequelize.INTEGER,
        defaultValue: 0,
        comment: 'æ’åºæƒé‡'
      },
      priority: {
        type: Sequelize.INTEGER,
        defaultValue: 0,
        comment: 'ä¼˜å…ˆçº§'
      },
      status: {
        type: Sequelize.ENUM('active', 'inactive'),
        defaultValue: 'active',
        comment: 'çŠ¶æ€'
      },
      start_time: {
        type: Sequelize.DATE,
        allowNull: true,
        comment: 'å¼€å§‹æ—¶é—´'
      },
      end_time: {
        type: Sequelize.DATE,
        allowNull: true,
        comment: 'ç»“æŸæ—¶é—´'
      },
      click_count: {
        type: Sequelize.INTEGER,
        defaultValue: 0,
        comment: 'ç‚¹å‡»æ¬¡æ•°'
      },
      view_count: {
        type: Sequelize.INTEGER,
        defaultValue: 0,
        comment: 'å±•ç¤ºæ¬¡æ•°'
      },
      tags: {
        type: Sequelize.JSON,
        allowNull: true,
        comment: 'æ ‡ç­¾ï¼ˆJSONæ•°ç»„ï¼‰'
      },
      created_at: {
        type: Sequelize.DATE,
        allowNull: false,
        defaultValue: Sequelize.NOW
      },
      updated_at: {
        type: Sequelize.DATE,
        allowNull: false,
        defaultValue: Sequelize.NOW
      },
      deleted_at: {
        type: Sequelize.DATE,
        allowNull: true
      }
    })

    // åˆ›å»ºç´¢å¼•
    await queryInterface.addIndex('banners', ['scene', 'platform', 'status'], {
      name: 'idx_banners_scene_platform_status'
    })

    await queryInterface.addIndex('banners', ['sort_order', 'priority'], {
      name: 'idx_banners_sort_priority'
    })

    await queryInterface.addIndex('banners', ['start_time', 'end_time'], {
      name: 'idx_banners_time_range'
    })
  },

  async down(queryInterface, Sequelize) {
    await queryInterface.dropTable('banners')
  }
}
```

### ç§å­æ•°æ®
```javascript
// server/src/seeders/20250108000001-demo-banners.js
'use strict'
const { v4: uuidv4 } = require('uuid')

module.exports = {
  async up(queryInterface, Sequelize) {
    const banners = [
      {
        id: uuidv4(),
        title: 'æ¬¢è¿æ¥åˆ°æ ¡å›­å¢™',
        image: '/uploads/banners/welcome-banner.jpg',
        link_type: 'page',
        link_value: '/pages/about/index',
        scene: 'home',
        platform: 'all',
        sort_order: 1,
        priority: 10,
        status: 'active',
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: uuidv4(),
        title: 'å‘ç°çƒ­é—¨è¯é¢˜',
        image: '/uploads/banners/topics-banner.jpg',
        link_type: 'page',
        link_value: '/pages/topic/list',
        scene: 'discover',
        platform: 'all',
        sort_order: 1,
        priority: 8,
        status: 'active',
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: uuidv4(),
        title: 'æœç´¢å‘ç°æ›´å¤š',
        image: '/uploads/banners/search-banner.jpg',
        link_type: 'page',
        link_value: '/pages/search/index',
        scene: 'search-main',
        platform: 'all',
        sort_order: 1,
        priority: 6,
        status: 'active',
        created_at: new Date(),
        updated_at: new Date()
      }
    ]

    await queryInterface.bulkInsert('banners', banners)
  },

  async down(queryInterface, Sequelize) {
    await queryInterface.bulkDelete('banners', null, {})
  }
}
```

---

## âœ… å®æ–½å®ŒæˆçŠ¶æ€

### å·²å®ŒæˆåŠŸèƒ½ï¼ˆ2025-01-08ï¼‰

#### 1. æ•°æ®åº“å±‚é¢ âœ…
- âœ… åˆ›å»ºäº†bannersè¡¨ï¼ŒåŒ…å«å®Œæ•´çš„å­—æ®µè®¾è®¡
- âœ… æ’å…¥äº†ç¤ºä¾‹æ•°æ®ç”¨äºæµ‹è¯•
- âœ… æ”¯æŒå¤šåœºæ™¯ã€å¤šå¹³å°çš„è½®æ’­å›¾ç®¡ç†
- âœ… æ·»åŠ äº†å¿…è¦çš„æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½

#### 2. åç«¯API âœ…
- âœ… å®ç°äº†å®Œæ•´çš„è½®æ’­å›¾CRUDæ“ä½œ
- âœ… æ”¯æŒæŒ‰åœºæ™¯ã€å¹³å°ã€çŠ¶æ€ç­›é€‰
- âœ… å®ç°äº†ç‚¹å‡»ç»Ÿè®¡å’Œå±•ç¤ºç»Ÿè®¡
- âœ… æä¾›äº†ç®¡ç†åå°ä¸“ç”¨çš„APIæ¥å£
- âœ… æ·»åŠ äº†Redisç¼“å­˜ä¼˜åŒ–æ€§èƒ½
- âœ… å®ç°äº†æ•°æ®éªŒè¯å’Œé”™è¯¯å¤„ç†

#### 3. å‰ç«¯ç»„ä»¶ âœ…
- âœ… å¼€å‘äº†é€šç”¨çš„Bannerç»„ä»¶
- âœ… æ”¯æŒå¤šç§é…ç½®é€‰é¡¹ï¼ˆè‡ªåŠ¨æ’­æ”¾ã€æŒ‡ç¤ºå™¨ã€æ ‡é¢˜æ˜¾ç¤ºç­‰ï¼‰
- âœ… å®ç°äº†å“åº”å¼è®¾è®¡å’Œç§»åŠ¨ç«¯é€‚é…
- âœ… é›†æˆåˆ°é¦–é¡µã€å‘ç°é¡µã€æœç´¢é¡µ
- âœ… å®ç°äº†ç‚¹å‡»ç»Ÿè®¡å’Œè·³è½¬é€»è¾‘
- âœ… æ·»åŠ äº†çŠ¶æ€ç®¡ç†å’Œç¼“å­˜æœºåˆ¶

#### 4. ç®¡ç†åå° âœ…
- âœ… å®Œæ•´çš„è½®æ’­å›¾ç®¡ç†ç•Œé¢
- âœ… æ”¯æŒåˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤è½®æ’­å›¾
- âœ… å®ç°äº†çŠ¶æ€åˆ‡æ¢å’Œç»Ÿè®¡æŸ¥çœ‹
- âœ… æä¾›äº†å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½
- âœ… æ”¯æŒç­›é€‰ã€æ’åºå’Œåˆ†é¡µ
- âœ… å“åº”å¼è®¾è®¡é€‚é…ä¸åŒå±å¹•

#### 5. æµ‹è¯•éªŒè¯ âœ…
- âœ… APIæ¥å£æµ‹è¯•é€šè¿‡
- âœ… å‰ç«¯ç»„ä»¶æ˜¾ç¤ºæ­£å¸¸
- âœ… ç®¡ç†åå°åŠŸèƒ½å®Œæ•´
- âœ… å¤šåœºæ™¯é›†æˆæµ‹è¯•é€šè¿‡
- âœ… ç§»åŠ¨ç«¯é€‚é…æµ‹è¯•é€šè¿‡

### æŠ€æœ¯ç‰¹æ€§

#### æ€§èƒ½ä¼˜åŒ–
- âœ… Redisç¼“å­˜æœºåˆ¶ï¼Œ5åˆ†é’Ÿç¼“å­˜æœ‰æ•ˆæœŸ
- âœ… å›¾ç‰‡æ‡’åŠ è½½å’Œé”™è¯¯å¤„ç†
- âœ… æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½
- âœ… å‰ç«¯çŠ¶æ€ç®¡ç†å’Œæ•°æ®ç¼“å­˜

#### å®‰å…¨ç‰¹æ€§
- âœ… è¾“å…¥éªŒè¯å’Œæ•°æ®æ ¡éªŒ
- âœ… ç®¡ç†å‘˜æƒé™æ§åˆ¶
- âœ… æ–‡ä»¶ä¸Šä¼ å®‰å…¨é™åˆ¶
- âœ… XSSé˜²æŠ¤å’Œå†…å®¹è¿‡æ»¤

#### æ‰©å±•æ€§
- âœ… å¤šåœºæ™¯æ”¯æŒï¼ˆé¦–é¡µã€å‘ç°é¡µã€æœç´¢é¡µï¼‰
- âœ… å¤šå¹³å°æ”¯æŒï¼ˆAPPã€Webã€ç®¡ç†åå°ï¼‰
- âœ… çµæ´»çš„é“¾æ¥ç±»å‹ï¼ˆURLã€å¸–å­ã€è¯é¢˜ã€æ´»åŠ¨ã€é¡µé¢ï¼‰
- âœ… æ—¶é—´æ§åˆ¶å’Œè‡ªåŠ¨è¿‡æœŸ

### éƒ¨ç½²çŠ¶æ€
- âœ… æ•°æ®åº“è¿ç§»è„šæœ¬å·²æ‰§è¡Œ
- âœ… ç¤ºä¾‹æ•°æ®å·²æ’å…¥
- âœ… åç«¯æœåŠ¡å·²éƒ¨ç½²å¹¶è¿è¡Œ
- âœ… å‰ç«¯ç»„ä»¶å·²é›†æˆå¹¶æµ‹è¯•
- âœ… ç®¡ç†åå°å·²éƒ¨ç½²å¹¶å¯ç”¨

### ä¸‹ä¸€æ­¥è®¡åˆ’
- [ ] æ·»åŠ æ›´å¤šè½®æ’­å›¾æ¨¡æ¿å’Œæ ·å¼
- [ ] å®ç°A/Bæµ‹è¯•åŠŸèƒ½
- [ ] æ·»åŠ è¯¦ç»†çš„æ•°æ®åˆ†ææŠ¥è¡¨
- [ ] ä¼˜åŒ–å›¾ç‰‡å‹ç¼©å’ŒCDNé›†æˆ
- [ ] æ·»åŠ è½®æ’­å›¾å†…å®¹å®¡æ ¸æµç¨‹

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.1
**åˆ›å»ºæ—¶é—´**ï¼š2025-01-08
**æœ€åæ›´æ–°**ï¼š2025-01-08
**ç»´æŠ¤è€…**ï¼šæ ¡å›­å¢™å¼€å‘å›¢é˜Ÿ
**æ›´æ–°è®°å½•**ï¼š
- v1.0: åˆå§‹ç‰ˆæœ¬åˆ›å»ºï¼Œæ·»åŠ å®Œæ•´æŠ€æœ¯å®ç°ç»†èŠ‚å’Œéƒ¨ç½²è„šæœ¬
- v1.1: æ›´æ–°å®æ–½å®ŒæˆçŠ¶æ€ï¼Œæ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½å·²å®Œæˆå¹¶æµ‹è¯•é€šè¿‡
